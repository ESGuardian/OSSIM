# Alienvault plugin
# Author: esguardian, http://eguardian.ru, especialy for Maruad team, http://maruad.ru
# Plugin kasper_rus id:9101 version: 1.0.0
# Last modification: 2017-07-08 22:15
#
# Plugin Selection Info:
# Kaspersky:Endpoint Security 10 for Windows:-
#
# END-HEADER
# Description:
# for use with snare agent 
#

[DEFAULT]
plugin_id=9101

[config]
type=detector
enable=yes
custom_functions_file=/etc/ossim/agent/plugins/custom_functions/kasper_rus_functions.cfg
source=log
location=/var/log/kasper-2017-07-08.18.45.50.log
bookmark_mode=byline

create_file=true

process=
start=no
stop=no
startup=
shutdown=

[0001 - Application Activity Control rule]

event_type=event
precheck="Сработало правило Контроля активности программ"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Сработало правило Контроля активности программ\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Результат\\Тип:\s+(?P<res_type>.+?)\s+Результат\\Название:\s+(?P<res_name>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=1
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$reason}
userdata8={$proc_id}
userdat9={$action}

[0002 - Application Activity Control rule]

event_type=event
precheck="Сработало правило Контроля активности программ"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Сработало правило Контроля активности программ\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=1
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}




[0003 - Object not processed]

event_type=event
precheck="Объект не обработан"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Объект не обработан\s+Программа\\Название:\s+(?P<progname>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=2
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$reason}

[0004 - Object not processed]

event_type=event
precheck="Объект не обработан"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Объект не обработан\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=2
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$obj_type}
userdata5={$obj_path}
userdata6={$obj_name}
userdata7={$reason}
userdata9={$res_desc}

[0005 - Task completed]

event_type=event
precheck="Задача завершена"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Задача завершена\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+"

plugin_sid=3
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_type}

[0006 - Task started]

event_type=event
precheck="Задача запущена"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Задача запущена\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=4
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_type}

[0007 - There are unprocessed files]

event_type=event
precheck="Есть необработанные файлы"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Есть необработанные файлы\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=5
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$progpath}

[0008 - Program is allowed in test mode]

event_type=event
precheck="Запуск программы разрешен в тестовом режиме"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Запуск программы разрешен в тестовом режиме\s+Объект\\Название файла:\s+(?P<obj_filename>.+?)\s+Объект\\Версия файла:\s+(?P<obj_fileversion>.+?)\s+Объект\\Название программы:\s+(?P<obj_progname>.+?)\s+Объект\\Путь к файлу:\s+(?P<obj_filepath>.+?)\s+Объект\\Источник:\s+(?P<obj_source>.+?)\s+Объект\\Производитель:\s+(?P<obj_vendor>.+?)\s+KL-категория\\Название:\s+(?P<KL_category_name>.+?)\s+KL-категория\\Источник:\s+(?P<KL_category_source>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Правило\\Категория:\s+(?P<rule_category>.+?)\s+Правило\\Тип правила:\s+(?P<rule_type>.+)"

plugin_sid=6
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$obj_filename}
userdata4={$obj_filepath}
userdata5={$obj_vendor}
userdata6={$KL_category_name}
userdata7={$KL_category_source}
userdata8={$rule_category}
userdata9={$rule_type}

[0009 - Action is blocked by self-defense]

event_type=event
precheck="Действие заблокировано самозащитой"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Действие заблокировано самозащитой\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=7
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$proc_id}
userdata8={$obj_type}
userdata9={$action}

[0010 - Action is blocked by self-defense]

event_type=event
precheck="Действие заблокировано самозащитой"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Действие заблокировано самозащитой\s+Программа\\Название:\s+(?P<progname>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=7
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_type}
userdata8={$action}



[0011 - Action is blocked by self-defense]

event_type=event
precheck="Действие с ресурсами продукта заблокировано самозащитой"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Действие с ресурсами продукта заблокировано самозащитой\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+)"

plugin_sid=7
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$result}
userdata5={$object}
userdata6={$obj_name}
userdata7={$proc_id}
userdata8={$obj_type}
userdata9={$action}


[0012 - Action is blocked by self-defense]

event_type=event
precheck="Действие с ресурсами продукта заблокировано самозащитой"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Действие с ресурсами продукта заблокировано самозащитой\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+)"

plugin_sid=7
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
userdata1={$host}
username={$user}
userdata2={$component}
userdata3={$progname}
userdata4={$result}
userdata5={$object}
userdata6={$obj_name}
userdata7={$proc_id}
userdata8={$obj_type}
userdata9={$action}

[0013 - The program is placed in a group of trusted programs]

event_type=event
precheck="Программа помещена в группу доверенных программ"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Программа помещена в группу доверенных программ\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"
plugin_sid=8
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata5={$object}
userdata6={$obj_name}
userdata7={$reason}
userdata8={$obj_type}
userdata9={$action}

[0014 - No updates available]

event_type=event
precheck="Нет доступных обновлений"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Нет доступных обновлений\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"
plugin_sid=9
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata5={$update_id}

[0015 - No updates available]

event_type=event
precheck="Нет доступных обновлений"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Нет доступных обновлений\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+)\)\s+Дата выпуска:\s+(?P<issue_date>.+)"
plugin_sid=9
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata5={$issue_date}

[0016 - Network upgrade error]

event_type=event
precheck="Сетевая ошибка обновления"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Сетевая ошибка обновления\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"
plugin_sid=10
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata5={$update_id}

[0017 - Information about the detected object]

event_type=event
precheck="Информация об обнаруженном объекте"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Информация об обнаруженном объекте\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Результат\\Тип:\s+(?P<res_type>.+?)\s+Результат\\Название:\s+(?P<res_name>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=11
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_type}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_path}
userdata8={$obj_type}
userdata9={$reason}

[0018 - Information about the detected object]

event_type=event
precheck="Информация об обнаруженном объекте"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Информация об обнаруженном объекте\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Результат\\Тип:\s+(?P<res_type>.+?)\s+Результат\\Название:\s+(?P<res_name>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=11
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$obj_name}
userdata4={$res_type}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_path}
userdata8={$res_name}
userdata9={$obj_type}


[0019 - Information about the detected object]

event_type=event
precheck="Информация об обнаруженном объекте"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Информация об обнаруженном объекте\s+Программа\\Название:\s+(?P<progname>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Результат\\Тип:\s+(?P<res_type>.+?)\s+Результат\\Название:\s+(?P<res_name>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=11
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_type}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_path}
userdata9={$obj_type}

[0020 - Task stoped]

event_type=event
precheck="Задача остановлена"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Задача остановлена\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=12
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_type}
userdata8={$res_desk}

[0021 - Protection components are disabled]

event_type=event
precheck="Компоненты защиты выключены"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Компоненты защиты выключены\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=13
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata5={$progpath}
userdata6={$res_desc}

[0022 - Group policy applied]

event_type=event
precheck="Применена групповая политика"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Применена групповая политика\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=14
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata5={$progpath}
userdata6={$res_desc}

[0023 - Task started]

event_type=event
precheck="Задача запущена"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Задача запущена\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Параметры проверки:\s+(?P<params>.+?)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=4
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_type}
userdata8={$params}

[00024 - Program is allowed in test mode]

event_type=event
precheck="Запуск программы разрешен в тестовом режиме"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Запуск программы разрешен в тестовом режиме\s+Объект\\Версия файла:\s+(?P<obj_fileversion>.+?)\s+Объект\\Путь к файлу:\s+(?P<obj_filepath>.+?)\s+Объект\\Источник:\s+(?P<obj_source>.+?)\s+Объект\\Производитель:\s+(?P<obj_vendor>.+?)\s+KL-категория\\Название:\s+(?P<KL_category_name>.+?)\s+KL-категория\\Источник:\s+(?P<KL_category_source>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Правило\\Категория:\s+(?P<rule_category>.+?)\s+Правило\\Тип правила:\s+(?P<rule_type>.+)"

plugin_sid=6
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$obj_source}
userdata4={$obj_filepath}
userdata5={$obj_vendor}
userdata6={$KL_category_name}
userdata7={$KL_category_source}
userdata8={$rule_category}
userdata9={$rule_type}



[0025 - Task uncompleted]

event_type=event
precheck="Не удалось выполнить задачу"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Не удалось выполнить задачу\s+Объект:\s+(?P<object>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"

plugin_sid=15
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$obj_name}
userdata5={$reason}
userdata6={$update_id}

[0026 - Task uncompleted]

event_type=event
precheck="Не удалось выполнить задачу"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Не удалось выполнить задачу\s+Результат:\s+(?P<result>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"

plugin_sid=15
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$obj_name}
userdata5={$reason}
userdata6={$update_id}

[0027 - Task uncompleted]

event_type=event
precheck="Не удалось выполнить задачу"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Не удалось выполнить задачу\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=15
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$object}
userdata6={$res_desc}
userdata7={$reason}

[0028 - Task uncompleted]

event_type=event
precheck="Не удалось выполнить задачу"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Не удалось выполнить задачу\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=15
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$object}
userdata6={$res_desc}

[0029 - Task uncompleted]

event_type=event
precheck="Не удалось выполнить задачу"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Не удалось выполнить задачу\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=15
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata6={$res_desc}

[0030 - Task uncompleted]

event_type=event
precheck="Не удалось выполнить задачу"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Не удалось выполнить задачу\s+Результат:\s+(?P<result>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Дата выпуска:\s+(?P<issue_date>.+)"

plugin_sid=15
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$reason}
userdata5={$result}


[00031 - Program is allowed in test mode]

event_type=event
precheck="Запуск программы разрешен в тестовом режиме"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Запуск программы разрешен в тестовом режиме\s+Объект\\Путь к файлу:\s+(?P<obj_filepath>.+?)\s+Объект\\Источник:\s+(?P<obj_source>.+?)\s+KL-категория\\Название:\s+(?P<KL_category_name>.+?)\s+KL-категория\\Источник:\s+(?P<KL_category_source>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Правило\\Категория:\s+(?P<rule_category>.+?)\s+Правило\\Тип правила:\s+(?P<rule_type>.+)"

plugin_sid=6
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$obj_filepath}
userdata4={$obj_source}
userdata5={$KL_category_name}
userdata6={$KL_category_source}
userdata7={$rule_category}
userdata8={$rule_type}

[0032 - The program is placed in a group with limitations]

event_type=event
precheck="Программа помещена в группу с ограничениями"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Программа помещена в группу с ограничениями\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"
plugin_sid=16
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$object}
userdata5={$obj_name}
userdata6={$reason}
userdata7={$proc_id}
userdata8={$obj_type}
userdata9={$action}

[0033 - The program is placed in a group with limitations]


event_type=event
precheck="Программа помещена в группу с ограничениями"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Программа помещена в группу с ограничениями\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"
plugin_sid=16
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata5={$object}
userdata6={$obj_name}
userdata7={$reason}
userdata8={$obj_type}
userdata9={$action}

[0034 - Network Attack Detected]

event_type=event
precheck="Обнаружена сетевая атака"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Обнаружена сетевая атака\s+Программа\\Название:\s+(?P<progname>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Результат\\Название:\s+(?P<res_name>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"
plugin_sid=17
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_string($object)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}
userdata5={$object}
userdata6={$obj_name}
userdata7={$obj_type}
userdata8={$res_name}

[0035 - Suspicious network activity detected]

event_type=event
precheck="Обнаружена подозрительная сетевая активность"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Обнаружена подозрительная сетевая активность\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"
plugin_sid=18
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_string($object)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$object}
userdata6={$obj_name}
userdata7={$reason}

[0036 - Changed program settings]

event_type=event
precheck="Изменены параметры программы"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Изменены параметры программы\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+)"

plugin_sid=19
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}

[0037 - Changed program settings]

event_type=event
precheck="Изменены параметры программы"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Изменены параметры программы\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Параметры проверки:\s+(?P<params>.+?)\s+Компонент:\s+(?P<component>.+)"

plugin_sid=19
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata8={$params}

[0038 - A backup copy of the object was created]

event_type=event
precheck="Создана резервная копия объекта"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Создана резервная копия объекта\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Результат\\Тип:\s+(?P<res_type>.+?)\s+Результат\\Название:\s+(?P<res_name>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=20
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$res_desc}
userdata6={$res_type}
userdata7={$res_name}
userdata8={$object}
userdata9={$obj_name}


[0039 - The object was renamed]

event_type=event
precheck="Объект переименован"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Объект переименован\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"

plugin_sid=21
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$res_desc}
userdata8={$obj_type}
userdata9={$obj_name}

[0040 - The object is corrupted]

event_type=event
precheck="Объект поврежден"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Объект поврежден\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=22
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$obj_path}
userdata5={$res_desc}
userdata8={$obj_type}
userdata9={$obj_name}

[0041 - Processing error]

event_type=event
precheck="Ошибка обработки"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Ошибка обработки\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=23
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$obj_path}
userdata5={$res_desc}
userdata6={$obj_type}
userdata7={$obj_name}
userdata8={$reason}

[0042 - Processing error]

event_type=event
precheck="Ошибка обработки"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Ошибка обработки\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=23
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$obj_path}
userdata5={$res_desc}
userdata6={$obj_type}
userdata7={$obj_name}
userdata8={$reason}

[0043 - Processing error]

event_type=event
precheck="Ошибка обработки"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Ошибка обработки\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"

plugin_sid=23
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$res_desc}
userdata6={$object}
userdata7={$obj_path}
userdata8={$reason}


[0044 - Not all components have been updated]

event_type=event
precheck="Обновлены не все компоненты"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Обновлены не все компоненты\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"

plugin_sid=24
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata4={update_id}


[0045 - Component update failed]

event_type=event
precheck="Ошибка обновления компонента"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Ошибка обновления компонента\s+Результат:\s+(?P<result>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"

plugin_sid=25
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$<obj_path}
userdata5={$result}
userdata6={update_id}

[0046 - Error communicating with Kaspersky Security Center]

event_type=event
precheck="Ошибка взаимодействия с Kaspersky Security Center"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Ошибка взаимодействия с Kaspersky Security Center\s+Результат:\s+(?P<result>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Дата выпуска:\s+(?P<update_date>.+)"

plugin_sid=26
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata4={$object}

[0047 - Error communicating with Kaspersky Security Center]

event_type=event
precheck="Ошибка взаимодействия с Kaspersky Security Center"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Ошибка взаимодействия с Kaspersky Security Center\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"

plugin_sid=26
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata4={$update_id}



[0048 - Network Firewall Event]

event_type=event
precheck="Сетевой экран"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Программа:\s+(?P<program>.+?)\s+Событие\\Протокол:\s+(?P<event_proto>.+?)\s+Событие\\Статус:\s+(?P<event_status>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Правило:\s+(?P<rule>.+)"

plugin_sid=27
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$program}
userdata4={$event_proto}
userdata5={$event_status}
userdata6={$rule}

[0049 - Application Activity Control Event]

event_type=event
precheck="Контроль активности программ"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"

plugin_sid=28
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$result}


[0050 - Self-defense of the program is turned off]

event_type=event
precheck="Самозащита программы выключена"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Самозащита программы выключена\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=29
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}

[0051 - Critical Alert]
event_type=event
precheck="Критический"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:.+?\"(?P<src_host>.+?)\".+\"(?P<status>.+?)\":\s+(?P<reason>.+)"
plugin_sid=30
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($src_host)}
src_ip={:get_ip_from_name($src_host)}
userdata1={$src_host}

userdata3={$status}
userdata4={$reason}

[0052 - Alert: Parameters have been changed by user]

event_type=event
precheck="изменен"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Параметры программы\s+\"(?P<progname>.+?)\"\s+были изменены пользователем\s+\"(?P<user>[^\"]*)"
plugin_sid=31
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
username={$user}
userdata1={$host}
userdata2={$progname}

[0053 - Alert: Parameters have been changed by user]

event_type=event
precheck="изменен"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Задача\s+\"(?P<task>.+?)\"\s+для программы\s+\"(?P<progname>.+?)\"\s+была изменена пользователем\s+\"(?P<user>[^\"]*)"
plugin_sid=31
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
username={$user}
userdata1={$host}
userdata2={$progname}
userdata2={$task}


[0054 - The task was started by the user]

event_type=event
precheck="запущен"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Задача\s+\"(?P<task>.+?)\"\s+для программы\s+\"(?P<progname>.+?)\"\s+была запущена пользователем\s+\"(?P<user>[^\"]*)"
plugin_sid=32
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
username={$user}
userdata1={$host}
userdata2={$progname}
userdata2={$task}

[0055 - Deleting events from the database]

event_type=event
precheck="удаление"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Началось удаление\s+.+?\s+событий из базы данных"
plugin_sid=33
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
userdata1={$host}

[0056 - Deleting events from the database]

event_type=event
precheck="Удалено"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Удалено\s+.+?\s+событий из базы данных"
plugin_sid=33
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
userdata1={$host}

[0057 - Detected not a virus]

event_type=event
precheck="Обнаружено: not-a-virus:"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"
plugin_sid=49
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata4={$object}

[0058 - Detected]

event_type=event
precheck="Обнаружено"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"
plugin_sid=34
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata4={$object}

[0059 - Runtime Error]

event_type=event
precheck="Ошибка времени выполнения"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Ошибка времени выполнения:"
plugin_sid=35
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
userdata1={$host}

[0060 - Runtime Error]

event_type=event
precheck="Ошибка времени выполнения"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Ошибка времени выполнения:"
plugin_sid=35
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
userdata1={$host}

[0061 - Password protected]

event_type=event
precheck="Защищено паролем"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"
plugin_sid=36
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata4={$object}

[0062 - Password protected]

event_type=event
precheck="Защищено паролем"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)"
plugin_sid=36
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}

[0063 - Password protected]

event_type=event
precheck="Защищено паролем"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)\s+Объект:\s+(?P<object>.+)"
plugin_sid=36
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
date={:normalize_date_kasper_rus($rdate)}
#username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$result}
userdata4={$object}

[0064 - Lost connection]

event_type=event
precheck="Потеряно соединение"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Потеряно соединение с компьютером \"(?P<src_host>.+?)\"\."
plugin_sid=37
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($src_host)}
src_ip={:get_ip_from_name($src_host)}
userdata1={$src_host}

[0065 - Computer removed from group]

event_type=event
precheck="удален из группы"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:Клиентский компьютер \"(?P<src_host>.+?)\" был автоматически удален из группы \"(?P<group_name>.+?)\".+"
plugin_sid=38
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($src_host)}
src_ip={:get_ip_from_name($src_host)}
userdata1={$src_host}
userdata2={$group_name}


[0066 - Database updated]

event_type=event
precheck="Базы обновлены"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]: Базы обновлены \("
plugin_sid=39
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
userdata1={$host}


[0067 - The program is not allowed to run]

event_type=event
precheck="Запуск программы запрещен"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Запуск программы запрещен\s+Объект\\Название файла:\s+(?P<obj_filename>.+?)\s+Объект\\Версия файла:\s+(?P<obj_fileversion>.+?)\s+Объект\\Название программы:\s+(?P<obj_progname>.+?)\s+Объект\\Путь к файлу:\s+(?P<obj_filepath>.+?)\s+Объект\\Производитель:\s+(?P<obj_vendor>.+?)\s+Объект\\KL-категория:\s+(?P<KL_category>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Правило\\Категория:\s+(?P<rule_category>.+?)\s+Правило\\Тип правила:\s+(?P<rule_type>.+)"
plugin_sid=40
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object_progname}
userdata4={$KL_category}
userdata5={$rule_category}
userdata6={$rule_type}

[0068 - Error checking databases]

event_type=event
precheck="Ошибка проверки баз"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Ошибка проверки баз и модулей программы\s+Результат:\s+(?P<result>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Идентификатор обновления:\s+(?P<update_id>.+)"
plugin_sid=41
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata4={$obj_path}
userdata5={$result}
userdata6={$update_id}

[0069 - Automatic update is off]

event_type=event
precheck="Автоматическое обновление выключено"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Автоматическое обновление выключено\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"
plugin_sid=42
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$res_desc}

[0070 - Application Activity Control rule]

event_type=event
precheck="Сработало правило Контроля активности программ"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Сработало правило Контроля активности программ\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=1
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$progpath}
userdata5={$res_desc}


[0071 - License Agreement Violated]

event_type=event
precheck="Нарушено лицензионное соглашение"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Нарушено лицензионное соглашение\s+Программа\\Название:\s+(?P<progname>.+?)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+)"

plugin_sid=43
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}

userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata4={$res_desc}

[0072 - The program is placed in a group of trusted programs]

event_type=event
precheck="Программа помещена в группу доверенных программ"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<tz>.+?)\):\s+Тип события:\s+Программа помещена в группу доверенных программ\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Степень угрозы:\s+(?P<res_severity>.+?)\s+Результат\\Точность:\s+(?P<res_actual>.+?)\s+Действие:\s+(?P<action>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Причина:\s+(?P<reason>.+)"
plugin_sid=8
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata5={$object}
userdata6={$obj_name}
userdata7={$reason}
userdata8={$obj_type}
userdata9={$action}

[0073 - Bad USB]

event_type=event
precheck="Защита от атак BadUSB"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Программа\s+(?P<progname>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\) .+ Результат:\s+(?P<result>.+)"
plugin_sid=44
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$progname}
userdata5={$result}


[0074 - Restricted]

event_type=event
precheck="Запрещено"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"
plugin_sid=45
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata5={$result}

[0075 - User has connected to admin server]

event_type=event
precheck="подключился к Серверу администрирования"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]: Пользователь \"(?P<user>.+?)\" подключился к Серверу администрирования c адреса \"(?P<src_ip>[^\"]*)"
plugin_sid=46
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($src_ip)}
username={$user}
userdata1={$host}

[0076 - Will be deleted on reboot]

event_type=event
precheck="Будет удалено при перезагрузке"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"
plugin_sid=47
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata5={$result}

[0077 - Quarantined]

event_type=event
precheck="Помещено в карантин"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"
plugin_sid=48
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata5={$result}

[0078 - Object corrupted]

event_type=event
precheck="Объект поврежден"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<module>.+?)\):\s+Тип события:\s+Объект поврежден\s+Программа\\Название:\s+(?P<progname>.+?)\s+Программа\\Путь:\s+(?P<progpath>.+?)\s+Программа\\ID процесса:\s+(?P<proc_id>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Компонент:\s+(?P<component>.+?)\s+Результат\\Описание:\s+(?P<res_desc>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Тип:\s+(?P<obj_type>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+)"
plugin_sid=50
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$obj_name}
userdata5={$res_desc}

[0079 - Computer status changed]

event_type=event
precheck="изменил свой статус"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]:\s+Компьютер \"(?P<computer>.+?)\" изменил свой статус на \"(?P<status>.+?)\":\s+(?P<reason>.+)"
plugin_sid=51
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($computer)}
src_ip={:get_ip_from_name($computer)}
userdata1={$computer}
userdata2={$status}
userdata3={$reason}

[0080 - Error checking databases and program modules]

event_type=event
precheck="Ошибка проверки баз и модулей программы"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Тип события:\s+Ошибка проверки баз и модулей программы\s+Результат:\s+(?P<result>.+?)\s+Объект:\s+(?P<object>.+?)\s+Объект\\Путь:\s+(?P<obj_path>.+?)\s+Объект\\Название:\s+(?P<obj_name>.+?)\s+Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+"
plugin_sid=52
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata5={$result}

[0081 - Deleted]

event_type=event
precheck="Удалено:"
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\]\s+\((?P<component>.+?)\):\s+Результат:\s+(?P<result>.+?)Пользователь:\s+(?P<user>.+?)\s+\((?P<usertype>.+?)\)\s+Объект:\s+(?P<object>.+)"
plugin_sid=53
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
username={$user}
userdata1={$host}
userdata2={$component}
userdata3={$object}
userdata5={$result}

[9998 - Generic Event]
event_type=event
regexp="(?P<host>.+)\s+\[(?P<rdate>.+?)\].+"
plugin_sid=9999
date={:normalize_date_kasper_rus($rdate)}
device={:get_ip_from_name($host)}
src_ip={:get_ip_from_name($host)}
userdata1={$host}

[9999 - Bad format log message]
event_type=event
regexp=".+"
plugin_sid=9998


